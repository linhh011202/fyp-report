sequenceDiagram
    participant Admin
    participant Controller as PlanController
    participant Service as PlanService
    participant Redis
    participant MongoDB

    Admin->>Controller: POST /plans {data: "json"}
    Controller->>Controller: Validate JSON structure
    Controller->>Service: create(plansJson)
    
    Service->>Service: generateId()
    Service->>MongoDB: Find latest version
    MongoDB-->>Service: version N
    Service->>Service: version = N + 1
    
    Service->>MongoDB: Insert {id, plans, version}
    MongoDB-->>Service: Plan document
    
    Service->>Redis: DEL plan:latest
    Note over Redis: Cache invalidated
    
    Service-->>Controller: Plan
    Controller-->>Admin: 201 Created
